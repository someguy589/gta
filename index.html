<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Home Alone Survival</title>
<style>
body { margin:0; overflow:hidden; background:#111; }
canvas { display:block; }
#hud {
    position:fixed;
    top:10px; left:10px;
    color:white;
    font-family:Arial;
    background:rgba(0,0,0,0.6);
    padding:8px;
}
</style>
</head>
<body>
<div id="hud">
‚ù§Ô∏è Health: <span id="hp">100</span><br>
üîë Keys: <span id="keys">0</span>/3
</div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

// WORLD
const world = { w: 1200, h: 800 };

// PLAYER
const player = {
    x: 100, y: 700,
    angle: 0,
    speed: 3,
    health: 100,
    keysCollected: 0,
    inSafeZone: true
};

// INPUT
const keys = {};
addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

let mouseX = 0, mouseY = 0;
addEventListener("mousemove", e => { mouseX = e.clientX; mouseY = e.clientY; });

// KEYS
const houseKeys = [
    { x: 400, y: 200, collected:false },
    { x: 900, y: 500, collected:false },
    { x: 700, y: 100, collected:false }
];

// SAFE ZONE (player's room)
const safeZone = { x: 50, y: 650, w: 200, h: 150 };

// MONSTER
const monster = { x: 1100, y: 100, speed:1.5 };

// WALLS (simple room layout)
const walls = [
    {x:0,y:0,w:1200,h:20}, {x:0,y:0,w:20,h:800}, {x:0,y:780,w:1200,h:20}, {x:1180,y:0,w:20,h:800}, // boundaries
    {x:300,y:0,w:20,h:400}, {x:300,y:500,w:20,h:300}, {x:600,y:200,w:20,h:600}, {x:900,y:0,w:20,h:400}
];

// INTERACTION DISTANCE
const pickupDistance = 25;

function update(){
    // Camera rotation
    player.angle = Math.atan2(mouseY - canvas.height/2, mouseX - canvas.width/2);

    // Movement
    let speed = keys["shift"] ? 5 : 3;
    if(keys["w"]) player.y -= speed;
    if(keys["s"]) player.y += speed;
    if(keys["a"]) player.x -= speed;
    if(keys["d"]) player.x += speed;

    // Collision with walls
    walls.forEach(w=>{
        if(player.x> w.x && player.x < w.x+w.w && player.y > w.y && player.y < w.y+w.h){
            if(keys["w"]) player.y += speed;
            if(keys["s"]) player.y -= speed;
            if(keys["a"]) player.x += speed;
            if(keys["d"]) player.x -= speed;
        }
    });

    // Check safe zone
    player.inSafeZone = (player.x>safeZone.x && player.x<safeZone.x+safeZone.w && player.y>safeZone.y && player.y<safeZone.y+safeZone.h);

    // Monster movement (chase if player not in safe zone)
    if(!player.inSafeZone){
        const dist = Math.hypot(player.x-monster.x,player.y-monster.y);
        if(dist>0){
            const a = Math.atan2(player.y-monster.y, player.x-monster.x);
            monster.x += Math.cos(a)*monster.speed;
            monster.y += Math.sin(a)*monster.speed;
        }
        if(dist<30) player.health -= 0.5;
    }

    // Pickup keys
    houseKeys.forEach(k=>{
        if(!k.collected && Math.hypot(player.x-k.x,player.y-k.y)<pickupDistance && keys["e"]){
            k.collected = true;
            player.keysCollected++;
        }
    });

    document.getElementById("hp").textContent = Math.floor(player.health);
    document.getElementById("keys").textContent = player.keysCollected;

    // Death respawn in safe zone
    if(player.health<=0){
        player.x = safeZone.x+50;
        player.y = safeZone.y+50;
        player.health = 100;
    }
}

function draw(){
    ctx.fillStyle="#111";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    const camX = player.x - canvas.width/2;
    const camY = player.y - canvas.height/2;

    // Walls
    ctx.fillStyle="#444";
    walls.forEach(w=>{
        ctx.fillRect(w.x-camX,w.y-camY,w.w,w.h);
    });

    // Safe Zone (player's room)
    ctx.fillStyle="#0b3";
    ctx.fillRect(safeZone.x-camX,safeZone.y-camY,safeZone.w,safeZone.h);

    // Keys
    houseKeys.forEach(k=>{
        if(!k.collected){
            ctx.fillStyle="yellow";
            ctx.beginPath();
            ctx.arc(k.x-camX,k.y-camY,10,0,Math.PI*2);
            ctx.fill();
        }
    });

    // Monster
    ctx.fillStyle="red";
    ctx.beginPath();
    ctx.arc(monster.x-camX,monster.y-camY,20,0,Math.PI*2);
    ctx.fill();

    // Player (hoodie, black sweats, shoes)
    ctx.save();
    ctx.translate(canvas.width/2, canvas.height/2);
    ctx.rotate(player.angle);
    ctx.fillStyle="#222"; // hoodie
    ctx.fillRect(-10,-20,20,30);
    ctx.fillStyle="#000"; // pants
    ctx.fillRect(-10,10,20,15);
    ctx.fillStyle="#000"; // shoes
    ctx.fillRect(-10,25,20,5);
    ctx.restore();
}

function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
