<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>GTA Neon City – 3rd Person</title>
<style>
body { margin:0; overflow:hidden; background:#000; }
canvas { display:block; }
#hud {
    position:fixed;
    top:10px; left:10px;
    color:white;
    font-family:Arial;
    background:rgba(0,0,0,.6);
    padding:8px;
}
#crosshair {
    position:fixed;
    left:50%; top:50%;
    width:20px; height:20px;
    margin:-10px;
    pointer-events:none;
}
#crosshair:before, #crosshair:after {
    content:"";
    position:absolute;
    background:white;
}
#crosshair:before { width:20px; height:2px; top:9px; }
#crosshair:after { height:20px; width:2px; left:9px; }
</style>
</head>
<body>

<div id="hud">❤️ Health: <span id="hp">100</span></div>
<div id="crosshair"></div>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = innerWidth;
canvas.height = innerHeight;

const world = { w: 4000, h: 4000 };

const player = {
    x: world.w/2,
    y: world.h/2,
    angle: 0,
    speed: 3,
    health: 100,
    cooldown: 0
};

const keys = {};
addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

let mouseX = 0, mouseY = 0;
addEventListener("mousemove", e => {
    mouseX = e.clientX;
    mouseY = e.clientY;
});

const bullets = [];
addEventListener("mousedown", () => {
    if (player.cooldown <= 0) {
        bullets.push({
            x: player.x,
            y: player.y,
            a: player.angle,
            s: 12,
            fromPlayer: true
        });
        player.cooldown = 15;
    }
});

const enemies = [];
for (let i=0;i<8;i++){
    enemies.push({
        x: Math.random()*world.w,
        y: Math.random()*world.h,
        hp: 60,
        shoot: Math.random()*120
    });
}

function update(){
    // Aim
    player.angle = Math.atan2(
        mouseY - canvas.height*0.65,
        mouseX - canvas.width/2
    );

    let moveSpeed = keys["shift"] ? 5 : 3;

    if (keys["w"]) {
        player.x += Math.cos(player.angle)*moveSpeed;
        player.y += Math.sin(player.angle)*moveSpeed;
    }
    if (keys["s"]) {
        player.x -= Math.cos(player.angle)*moveSpeed;
        player.y -= Math.sin(player.angle)*moveSpeed;
    }
    if (keys["a"]) {
        player.x += Math.cos(player.angle-Math.PI/2)*moveSpeed;
        player.y += Math.sin(player.angle-Math.PI/2)*moveSpeed;
    }
    if (keys["d"]) {
        player.x += Math.cos(player.angle+Math.PI/2)*moveSpeed;
        player.y += Math.sin(player.angle+Math.PI/2)*moveSpeed;
    }

    bullets.forEach(b=>{
        b.x += Math.cos(b.a)*b.s;
        b.y += Math.sin(b.a)*b.s;
    });

    enemies.forEach(e=>{
        e.shoot--;
        if (e.shoot <= 0){
            e.shoot = 120;
            bullets.push({
                x:e.x, y:e.y,
                a:Math.atan2(player.y-e.y, player.x-e.x),
                s:6, fromPlayer:false
            });
        }
    });

    bullets.forEach((b,i)=>{
        if (!b.fromPlayer) {
            if (Math.hypot(b.x-player.x,b.y-player.y)<20){
                player.health -= 5;
                bullets.splice(i,1);
            }
        }
        enemies.forEach((e,ei)=>{
            if (b.fromPlayer && Math.hypot(b.x-e.x,b.y-e.y)<20){
                e.hp -= 20;
                bullets.splice(i,1);
                if (e.hp<=0) enemies.splice(ei,1);
            }
        });
    });

    if (player.cooldown>0) player.cooldown--;
    document.getElementById("hp").textContent = player.health;
}

function draw(){
    // CAMERA BEHIND PLAYER
    const camX = player.x - canvas.width/2 + Math.cos(player.angle)*150;
    const camY = player.y - canvas.height*0.65 + Math.sin(player.angle)*150;

    ctx.fillStyle="#1c1c1c";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Ground grid
    ctx.fillStyle="#333";
    for(let i=0;i<world.w;i+=200){
        ctx.fillRect(i-camX,0-camY,40,world.h);
        ctx.fillRect(0-camX,i-camY,world.w,40);
    }

    // Enemies
    enemies.forEach(e=>{
        ctx.fillStyle="red";
        ctx.beginPath();
        ctx.arc(e.x-camX,e.y-camY,18,0,Math.PI*2);
        ctx.fill();
    });

    // Bullets
    ctx.fillStyle="yellow";
    bullets.forEach(b=>{
        ctx.fillRect(b.x-camX,b.y-camY,4,4);
    });

    // PLAYER BODY (VISIBLE)
    ctx.save();
    ctx.translate(canvas.width/2, canvas.height*0.65);
    ctx.rotate(player.angle);
    ctx.fillStyle="#00ffff";
    ctx.fillRect(-10,-20,20,30); // body
    ctx.fillStyle="#fff";
    ctx.fillRect(10,-5,18,6); // gun
    ctx.restore();
}

function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>

        
